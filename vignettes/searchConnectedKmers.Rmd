---
title: "graphSearch"
author: "Gaurav"
date: "5/13/2019"
output: html_document
---

```{r}
kmer10kE05X30DfRefA <- read.table("D:/JHU/Spring19/601.749ComparativeGenomics/Project/kmers10kE05X30Df_refA.txt",sep = '\t', header = TRUE, stringsAsFactors = F)
```
Now write function to cluster the data
```{r}
#First find indices that are connected in a directional way (it means not all connected indices have a non-zero
#value for the connected, but only those who have lower node number)
connectedIndices <- kmer10kE05X30DfRefA$index[which(kmer10kE05X30DfRefA$connected != '0')]
```

```{r}
#Function to check for connected nodes of a node given it is connected to at least one node (Not to be called on nodes with 
#connected == 0)
searchedIndices <- NULL
kmer10kE05X30DfRefA$markDeletion <- 0
checkConnected <- function(index, passedVector = NULL){
      connectedNodes <- as.numeric(strsplit(kmer10kE05X30DfRefA$connected[index],',',fixed = T)[[1]]) #find all connected nodes
      if(length(connectedNodes) == 1){
            if(kmer10kE05X30DfRefA$connected[connectedNodes] == '0'){ #if the node is not connected further
                  return(c(connectedNodes,index,passedVector))
            }else{
                  if(!(connectedNodes %in% searchedIndices)){
                        searchedIndices <<- c(searchedIndices,connectedNodes)
                        return(checkConnected(connectedNodes,c(index,passedVector)))
                  } else {
                        return(c(connectedNodes,index,passedVector))
                  }
            }
      }else{
            connectedNodeVector <- NULL
            sapply(1:length(connectedNodes),function(x){
                  if(kmer10kE05X30DfRefA$connected[connectedNodes[x]] == "0"){
                        connectedNodeVector <<- c(connectedNodeVector,connectedNodes[x])
                  }else{
                        connectedNodeVector <<- c(connectedNodeVector,checkConnected(connectedNodes[x]))
                        searchedIndices <<- c(searchedIndices,connectedNodes[x])
                  }
                  1
            })
            return(c(connectedNodeVector,index,passedVector))
            
      }
}
```
test the function
```{r}
searchedIndices <- NULL
sapply(1:15, function(x) {
      if(!(connectedIndices[x] %in% searchedIndices)){
            indices <- checkConnected(connectedIndices[x])
      }
})
```

